<head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Raspberry Pi Pico is a tiny, fast, and versatile board built using RP2040, a brand new microcontroller chip designed by Raspberry Pi in the UK. — Rasp"><meta name="author" content="Ryan Walker"><meta property="og:title" content="Flashing the RP2040 with a Jlink and OpenOCD"><meta property="og:description" content="Raspberry Pi Pico is a tiny, fast, and versatile board built using RP2040, a brand new microcontroller chip designed by Raspberry Pi in the UK. — Rasp"><meta property="og:site_name" content="Interrupt Labs Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://interruptlabs.caimg/home-bg.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://interruptlabs.caimg/home-bg.jpg"><title>Flashing the RP2040 with a Jlink and OpenOCD - Interrupt Labs Blog</title><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=G-JPDQ8MSX3T"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JPDQ8MSX3T")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Interrupt Labs Blog" type="application/rss+xml">
</head><nav><a class="navbar-brand" href="/"><img src="/img/home-icon.png" alt="Homepage" style="width:60px"></a></nav><style>.column{float:left;width:50%}.row:after{content:"";display:table;clear:both}.stroke{-webkit-text-stroke:1px #000}</style><header class="intro-header" style="background-image:url(/img/home-bg.jpg)"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1 class="stroke">Flashing the RP2040 with a Jlink and OpenOCD</h1><span class="meta">2022-03-08</span></div></div></div></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><blockquote><p>Raspberry Pi Pico is a tiny, fast, and versatile board built using RP2040, a brand new microcontroller chip designed by Raspberry Pi in the UK. — Raspberry Pi People</p></blockquote><p>I picked up a Pico for a couple of bucks to try it out. In a time of extreme scarcity and shortage in silicon, I’ve started evaluating different options, and the RP2040 is very available. It hosts a dual Cortex M0+ processor with 264k RAM and all the usual peripherals. However, it lacks flash. The chip requires an external QSPI flash to hold the program instructions.<br><img src="https://cdn-images-1.medium.com/max/687/1*Uu8Z74Z2he-8lcompmJlXw.png"></p><p>To program the chip, you hold the boot button while plugging in a USB cable; the chip will come up as a mass storage device. Then drag and drop in the image. This would be incredible functionality if I needed a client to flash their device. However, for development, I reached for my Jtag programmer.</p><p>It seems like most people are using the Pico Probe, which is another Pico board acting as a programmer. This is an excellent solution for someone that doesn’t have a Jtag debugger, but I only have a Jlink and don’t want to buy another Pico just yet.</p><p>Let’s get going: start by removing openocd. The version of openocd for this is not upstreamed yet.</p><pre>git clone https://github.com/raspberrypi/openocd.git
cd openocd 
./bootstrap 
./configure --enable-picoprobe
make -j$(nproc)
sudo make install</pre><p>As for wiring…</p><ul><li><strong>Pico SWDIO</strong> to <strong>Jlink SWDIO, Pin 7</strong></li><li><strong>Pico SWCLK</strong> to <strong>Jlink SWCLK, Pin 9</strong></li><li><strong>Pico GND</strong> to <strong>Jlink GND</strong></li><li>**Pico 3V3(OUT), Pin 36 **to <strong>Jlink VTref, Pin 1</strong></li><li>**Pico RUN, Pin 30 **to <strong>Jlink RESET, Pin 15</strong></li></ul><p>Here is the flash script I got working.</p><pre>#!/bin/bash</pre><pre>openocd -f interface/jlink.cfg -c &quot;transport select swd&quot; -c &quot;adapter_khz 6000&quot; -f target/rp2040.cfg  -c &quot;program blink.elf reset exit&quot;</pre><p>Good luck!</p></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><hr><h3 id="_authors">Author</h3><div style="display:flex"><div><img src="/img/me.jpg" style="width:350px"></div><div style="margin-left:25px"><h4>Ryan Walker<p style="font-weight:400">Building open source stuff with open source stuff. Operating a consulting company hit me up if you want something made.</p><div style="display:flex"><div style="display:flex: 50%"><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/email.png" style="width:20px;padding-top:0;margin:0"> <a href="malto:info@interruptlabs.ca" style="margin-left:15px">Email</a></div><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/github.png" style="width:20px;padding-top:0;margin:0"> <a target="_blank" rel="noopener" href="https://github.com/o7-machinehum" style="margin-left:15px">GitHub</a></div></div><div style="display:flex: 50%;margin-left:10px"><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/discord.png" style="width:20px;padding-top:0;margin:0"> <a target="_blank" rel="noopener" href="https://discord.gg/EtZT7mjNuM" style="margin-left:15px">Discord</a></div><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/rss.png" style="width:20px;padding-top:0;margin:0"> <a href="https://interruptlabs.ca/atom.xml" style="margin-left:15px">RSS Feed</a></div></div><div style="display:flex: 50%;margin-left:10px"><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/twitter.png" style="width:20px;padding-top:0;margin:0"> <a target="_blank" rel="noopener" href="https://twitter.com/machinehum" style="margin-left:15px">Twitter</a></div><div style="display:flex;margin-top:5px;align-items:center"><img src="/img/youtube.png" style="width:20px;padding-top:0;margin:0"> <a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UC4aRhZpbWRGECh_Kr5wFIkA" style="margin-left:15px">Youtube</a></div></div></div></h4></div></div></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><hr><link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css"><style type="text/css">#mc_embed_signup{background:#fff;clear:left;font:14px Helvetica,Arial,sans-serif}#mc_embed_signup form{display:block;position:relative;text-align:left;margin:0}</style><div id="mc_embed_signup"><form action="https://interruptlabs.us10.list-manage.com/subscribe/post?u=01e9664f2845368a0228dc20f&amp;id=7eefc9b014&amp;f_id=005c35e2f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate style="margin:0"><div id="mc_embed_signup_scroll"><h3>Subscribe for Updates!</h3><div class="indicates-required"><span class="asterisk">*</span> indicates required</div><div class="mc-field-group" style="width:100%"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label> <input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required> <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span></div><div id="mce-responses" class="clear"><div class="response" id="mce-error-response" style="display:none"></div><div class="response" id="mce-success-response" style="display:none"></div></div><div style="position:absolute;left:-5000px" aria-hidden="true"><input type="text" name="b_01e9664f2845368a0228dc20f_7eefc9b014" tabindex="-1"></div><div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div><script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">jQuery,window.fnames=new Array,window.ftypes=new Array,fnames[0]="EMAIL",ftypes[0]="email",fnames[1]="FNAME",ftypes[1]="text",fnames[2]="LNAME",ftypes[2]="text",fnames[3]="ADDRESS",ftypes[3]="address",fnames[4]="PHONE",ftypes[4]="phone",fnames[5]="BIRTHDAY",ftypes[5]="birthday";var $mcj=jQuery.noConflict(!0)</script></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><hr><link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css"><div id="mc_embed_signup"><h3>Request a Free Consultation!</h3><form accept-charset="UTF-8" action="https://getform.io/f/f2e6ca27-2160-4dc8-b510-0eea25c7da2c" method="POST" enctype="multipart/form-data" target="_blank" style="margin:0"><div class="form-group"><label for="exampleInputEmail1" required>Email Address</label> <span class="asterisk">*</span> <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email"></div><div class="form-group"><label for="exampleFormControlSelect1">Required Tech</label> <span class="asterisk">*</span> <select class="form-control" id="exampleFormControlSelect1" name="platform" required><option>Firmware</option><option>Electrical Engineering</option><option>Robotics</option><option>Linux</option></select></div><div class="form-group"><input type="checkbox" id="scales" name="newsletter" checked> <label for="newsletter">Subscribe to our Newsletter</label></div><div class="form-group"><label for="exampleInputName">Message</label> <span class="asterisk">*</span> <textarea name="comment" class="form-control" rows="10" cols="50" style="resize:none"></textarea></div><div class="clear"><input type="submit" value="Submit" name="submit" id="mc-embedded-subscribe" class="button"></div><br></form></div></div></div></div></article>